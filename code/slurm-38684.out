RANK and WORLD_SIZE in environ: 0/1
0
shell command : training/exp_runner.py --conf confs/RICO_scannet.conf --scan_id 1 --nepoch 1000
Loading data ...
Finish loading data. Data-set size: 465
RUNNING FOR 1000
RUNNING FOR 10 CLASSES
Instance IDs:  [2, 5, 13, 1, 12, 4, 14, 15, 19]
Label mappings:  [0, 2, 5, 13, 1, 12, 4, 14, 15, 19]
network architecture
[71, 256, 256, 256, 256, 256, 256, 256, 256, 266]
/ceph/home/wangkeran/anaconda3/envs/rico/lib/python3.8/site-packages/torch/nn/utils/weight_norm.py:28: UserWarning: torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.
  warnings.warn("torch.nn.utils.weight_norm is deprecated in favor of torch.nn.utils.parametrizations.weight_norm.")
rendering network architecture:
[321, 256, 256, 3]
using weight for loss RGB_1.0 SEMANTIC_0.04         Lop_0.1 Lrd_0.1 BG_RENDER_0.1         EK_0.05 SM_0.005         Depth_0.1 NormalL1_0.05 NormalCos_0.05
using optimizer w unified lr
training...
  0%|          | 0/144 [00:00<?, ?it/s]  1%|          | 1/144 [00:00<01:22,  1.74it/s]  2%|▏         | 3/144 [00:00<00:27,  5.19it/s]  3%|▎         | 5/144 [00:00<00:16,  8.18it/s]  5%|▍         | 7/144 [00:00<00:12, 10.66it/s]  6%|▋         | 9/144 [00:01<00:10, 12.62it/s]  8%|▊         | 11/144 [00:01<00:09, 14.11it/s]  9%|▉         | 13/144 [00:01<00:08, 15.27it/s] 10%|█         | 15/144 [00:01<00:08, 16.06it/s] 12%|█▏        | 17/144 [00:01<00:07, 16.58it/s] 13%|█▎        | 19/144 [00:01<00:07, 16.99it/s] 15%|█▍        | 21/144 [00:01<00:07, 17.16it/s] 16%|█▌        | 23/144 [00:01<00:06, 17.42it/s] 17%|█▋        | 25/144 [00:01<00:06, 17.60it/s] 19%|█▉        | 27/144 [00:02<00:06, 17.65it/s] 20%|██        | 29/144 [00:02<00:06, 17.71it/s] 22%|██▏       | 31/144 [00:02<00:06, 17.78it/s] 23%|██▎       | 33/144 [00:02<00:06, 17.70it/s] 24%|██▍       | 35/144 [00:02<00:06, 17.74it/s] 26%|██▌       | 37/144 [00:02<00:06, 17.79it/s] 27%|██▋       | 39/144 [00:02<00:05, 17.67it/s] 28%|██▊       | 41/144 [00:02<00:05, 17.43it/s] 30%|██▉       | 43/144 [00:02<00:05, 17.56it/s] 31%|███▏      | 45/144 [00:03<00:05, 17.57it/s] 33%|███▎      | 47/144 [00:03<00:05, 17.65it/s] 34%|███▍      | 49/144 [00:03<00:05, 17.74it/s] 35%|███▌      | 51/144 [00:03<00:05, 17.63it/s] 37%|███▋      | 53/144 [00:03<00:05, 17.70it/s] 38%|███▊      | 55/144 [00:03<00:05, 17.72it/s] 40%|███▉      | 57/144 [00:03<00:04, 17.68it/s] 41%|████      | 59/144 [00:03<00:04, 17.54it/s] 42%|████▏     | 61/144 [00:03<00:04, 17.58it/s] 44%|████▍     | 63/144 [00:04<00:04, 17.60it/s] 45%|████▌     | 65/144 [00:04<00:04, 17.55it/s] 47%|████▋     | 67/144 [00:04<00:04, 17.54it/s] 48%|████▊     | 69/144 [00:04<00:04, 17.52it/s] 49%|████▉     | 71/144 [00:04<00:04, 17.63it/s] 51%|█████     | 73/144 [00:04<00:04, 17.73it/s] 52%|█████▏    | 75/144 [00:04<00:03, 17.59it/s] 53%|█████▎    | 77/144 [00:04<00:03, 17.54it/s] 55%|█████▍    | 79/144 [00:04<00:03, 17.54it/s] 56%|█████▋    | 81/144 [00:05<00:03, 17.54it/s] 58%|█████▊    | 83/144 [00:05<00:03, 17.57it/s] 59%|█████▉    | 85/144 [00:05<00:03, 17.47it/s] 60%|██████    | 87/144 [00:05<00:03, 17.43it/s] 62%|██████▏   | 89/144 [00:05<00:03, 17.43it/s] 63%|██████▎   | 91/144 [00:05<00:03, 17.45it/s] 65%|██████▍   | 93/144 [00:05<00:02, 17.30it/s] 66%|██████▌   | 95/144 [00:05<00:02, 17.35it/s] 67%|██████▋   | 97/144 [00:06<00:02, 17.40it/s] 69%|██████▉   | 99/144 [00:06<00:02, 17.41it/s] 70%|███████   | 101/144 [00:06<00:02, 17.39it/s] 72%|███████▏  | 103/144 [00:06<00:02, 17.39it/s] 73%|███████▎  | 105/144 [00:06<00:02, 17.39it/s] 74%|███████▍  | 107/144 [00:06<00:02, 17.44it/s] 76%|███████▌  | 109/144 [00:06<00:02, 17.49it/s] 77%|███████▋  | 111/144 [00:06<00:01, 17.49it/s] 78%|███████▊  | 113/144 [00:06<00:01, 17.55it/s] 80%|███████▉  | 115/144 [00:07<00:01, 17.65it/s] 81%|████████▏ | 117/144 [00:07<00:01, 17.71it/s] 83%|████████▎ | 119/144 [00:07<00:01, 17.68it/s] 84%|████████▍ | 121/144 [00:07<00:01, 17.63it/s] 85%|████████▌ | 123/144 [00:07<00:01, 17.71it/s] 87%|████████▋ | 125/144 [00:07<00:01, 17.75it/s] 88%|████████▊ | 127/144 [00:07<00:00, 17.67it/s] 90%|████████▉ | 129/144 [00:07<00:00, 17.56it/s] 91%|█████████ | 131/144 [00:07<00:00, 17.64it/s] 92%|█████████▏| 133/144 [00:08<00:00, 17.63it/s] 94%|█████████▍| 135/144 [00:08<00:00, 17.66it/s] 95%|█████████▌| 137/144 [00:08<00:00, 17.72it/s] 97%|█████████▋| 139/144 [00:08<00:00, 17.55it/s] 98%|█████████▊| 141/144 [00:08<00:00, 17.62it/s] 99%|█████████▉| 143/144 [00:08<00:00, 17.69it/s]100%|██████████| 144/144 [00:08<00:00, 16.59it/s]
0
{'rgb_gt': tensor([[[0.9176, 0.8275, 0.7059],
         [0.9176, 0.8275, 0.7098],
         [0.9176, 0.8235, 0.7137],
         ...,
         [0.1176, 0.1137, 0.0980],
         [0.0941, 0.1373, 0.1176],
         [0.0863, 0.1333, 0.1294]]]), 'normal_gt': tensor([[[0.7611, 0.5851, 0.1866],
         [0.7918, 0.5702, 0.1878],
         [0.8058, 0.5950, 0.1885],
         ...,
         [0.4930, 0.0574, 0.2827],
         [0.4879, 0.0576, 0.2842],
         [0.4666, 0.0516, 0.2806]]]), 'depth_gt': tensor([[[0.0272],
         [0.0263],
         [0.0261],
         ...,
         [0.0192],
         [0.0192],
         [0.0196]]], device='cuda:0'), 'pose': tensor([[[-0.6415,  0.3634, -0.6756,  0.1151],
         [ 0.7670,  0.3177, -0.5574,  0.0144],
         [ 0.0121, -0.8758, -0.4826,  0.0787],
         [ 0.0000,  0.0000,  0.0000,  1.0000]]], device='cuda:0'), 'rgb_eval': tensor([[[0.4687, 0.4759, 0.4850],
         [0.4691, 0.4762, 0.4853],
         [0.4694, 0.4765, 0.4856],
         ...,
         [0.4894, 0.4943, 0.4999],
         [0.4894, 0.4943, 0.4999],
         [0.4894, 0.4943, 0.4999]]], device='cuda:0'), 'normal_map': tensor([[[0.6999, 0.5564, 0.0656],
         [0.6986, 0.5568, 0.0647],
         [0.6973, 0.5572, 0.0638],
         ...,
         [0.5341, 0.1409, 0.1538],
         [0.5335, 0.1405, 0.1542],
         [0.5329, 0.1400, 0.1546]]], device='cuda:0'), 'depth_map': tensor([[0.0225, 0.0226, 0.0226,  ..., 0.0186, 0.0186, 0.0186]],
       device='cuda:0'), 'pred_points': array([[-0.0073858 , -0.00738579,  0.02252186,  0.46874723,  0.47591364,
         0.48500854],
       [-0.00736226, -0.00740082,  0.02256768,  0.46908417,  0.47622973,
         0.48530027],
       [-0.00733846, -0.00741575,  0.0226132 ,  0.46941814,  0.47654256,
         0.48558834],
       ...,
       [ 0.00600918,  0.00607274,  0.01859059,  0.4894145 ,  0.4942547 ,
         0.4999102 ],
       [ 0.00604321,  0.00607501,  0.01859753,  0.48938996,  0.4942609 ,
         0.49990606],
       [ 0.00607723,  0.00607724,  0.01860435,  0.48936507,  0.49426693,
         0.49990183]], dtype=float32), 'gt_points': array([[-0.00892143, -0.00892141,  0.0272045 ,  0.46874723,  0.47591364,
         0.48500854],
       [-0.00857393, -0.00861883,  0.02628184,  0.46908417,  0.47622973,
         0.48530027],
       [-0.00846529, -0.00855444,  0.02608548,  0.46941814,  0.47654256,
         0.48558834],
       ...,
       [ 0.00619707,  0.00626262,  0.01917185,  0.4894145 ,  0.4942547 ,
         0.4999102 ],
       [ 0.00622292,  0.00625566,  0.01915056,  0.48938996,  0.4942609 ,
         0.49990606],
       [ 0.00639403,  0.00639404,  0.01957417,  0.48936507,  0.49426693,
         0.49990183]], dtype=float32), 'semantic_map': tensor([[[1],
         [1],
         [1],
         ...,
         [1],
         [1],
         [1]]], device='cuda:0'), 'semantic_gt': tensor([[[0.],
         [0.],
         [0.],
         ...,
         [0.],
         [0.],
         [0.]]])}
[-1.1  1.1]
[-1.1  1.1]
[-1.1  1.1]
0 0 0
ratio 0.16794586181640625
ratio 0.08382320404052734
ratio 0.04187953472137451
[-1.1 -1.1 -1.1]
0.0 2.0946326209141084
-1.1 0.9946326209141083
[-1.1  1.1]
[-1.1  1.1]
[-1.1  1.1]
0 0 0
ratio 0.167816162109375
ratio 0.0837407112121582
ratio 0.04186517000198364
[-1.1 -1.1 -1.1]
0.0 2.0944037450503
-1.1 0.9944037450502998
[-1.1  1.1]
[-1.1  1.1]
[-1.1  1.1]
0 0 0
ratio 0.16786575317382812
ratio 0.0837712287902832
ratio 0.04187178611755371
[-1.1 -1.1 -1.1]
0.0 2.094435146503486
-1.1 0.994435146503486
[-1.1  1.1]
[-1.1  1.1]
[-1.1  1.1]
0 0 0
ratio 0.16792678833007812
ratio 0.08380317687988281
ratio 0.04187595844268799
[-1.1 -1.1 -1.1]
0.0 2.0945066209408636
-1.1 0.9945066209408635
[-1.1  1.1]
[-1.1  1.1]
[-1.1  1.1]
0 0 0
ratio 0.16788482666015625
ratio 0.0837712287902832
ratio 0.04187488555908203
[-1.1 -1.1 -1.1]
0.0 2.094528825315711
-1.1 0.9945288253157107
[-1.1  1.1]
[-1.1  1.1]
[-1.1  1.1]
0 0 0
ratio 0.16793441772460938
ratio 0.08380508422851562
ratio 0.041878461837768555
[-1.1 -1.1 -1.1]
0.0 2.0945886063249146
-1.1 0.9945886063249145
[-1.1  1.1]
[-1.1  1.1]
[-1.1  1.1]
0 0 0
ratio 0.16792678833007812
ratio 0.08380413055419922
ratio 0.041878581047058105
[-1.1 -1.1 -1.1]
0.0 2.094552606332559
-1.1 0.9945526063325589
[-1.1  1.1]
[-1.1  1.1]
[-1.1  1.1]
0 0 0
ratio 0.16788101196289062
ratio 0.08377218246459961
ratio 0.0418776273727417
[-1.1 -1.1 -1.1]
0.0 2.0945273800605433
-1.1 0.9945273800605432
[-1.1  1.1]
[-1.1  1.1]
[-1.1  1.1]
0 0 0
ratio 0.167938232421875
ratio 0.08382177352905273
ratio 0.041880905628204346
[-1.1 -1.1 -1.1]
0.0 2.094671642803633
-1.1 0.9946716428036328
[-1.1  1.1]
[-1.1  1.1]
[-1.1  1.1]
0 0 0
ratio 0.16780853271484375
ratio 0.08374786376953125
ratio 0.0418628454208374
[-1.1 -1.1 -1.1]
0.0 2.0943923143957925
-1.1 0.9943923143957925
[-1.1  1.1]
[-1.1  1.1]
[-1.1  1.1]
0 0 0
ratio 0.16779708862304688
ratio 0.08374309539794922
ratio 0.04186016321182251
[-1.1 -1.1 -1.1]
0.0 2.0943923143957925
-1.1 0.9943923143957925
RICO_scannet_1_2024_05_13_17_50_05 [0] (0/465): loss = 0.5048918724060059, rgb_loss = 0.27277886867523193, eikonal_loss = 0.056775350123643875, bg_render_loss = 0.11983589828014374, lop_loss = 0.2421504110097885, lrd_loss = 0.0, semantic_loss = 2.307800769805908, smooth_loss = 0.0, depth_loss = 0.2797745168209076, normal_l1 = 1.155073642730713, normal_cos = 0.30064788460731506, psnr = 10.356268882751465
RICO_scannet_1_2024_05_13_17_50_05 [0] (25/465): loss = 0.5084795951843262, rgb_loss = 0.19985389709472656, eikonal_loss = 0.0906359851360321, bg_render_loss = 0.0, lop_loss = 0.1582975685596466, lrd_loss = 0.0, semantic_loss = 4.9685492515563965, smooth_loss = 0.0, depth_loss = 0.24964353442192078, normal_l1 = 1.0251870155334473, normal_cos = 0.2659698724746704, psnr = 12.632046699523926
RICO_scannet_1_2024_05_13_17_50_05 [0] (50/465): loss = 0.2963045835494995, rgb_loss = 0.09602352231740952, eikonal_loss = 0.1714211255311966, bg_render_loss = 0.0, lop_loss = 0.24326051771640778, lrd_loss = 0.0, semantic_loss = 2.4006941318511963, smooth_loss = 0.0, depth_loss = 0.1375226378440857, normal_l1 = 0.9545712471008301, normal_cos = 0.19750741124153137, psnr = 18.47707748413086
RICO_scannet_1_2024_05_13_17_50_05 [0] (75/465): loss = 0.32198119163513184, rgb_loss = 0.24930594861507416, eikonal_loss = 0.1744914948940277, bg_render_loss = 0.0, lop_loss = 0.07317647337913513, lrd_loss = 0.0, semantic_loss = 0.3292871117591858, smooth_loss = 0.0, depth_loss = 0.0836276262998581, normal_l1 = 0.5677449703216553, normal_cos = 0.13422946631908417, psnr = 10.60698127746582
RICO_scannet_1_2024_05_13_17_50_05 [0] (100/465): loss = 0.33107790350914, rgb_loss = 0.13505947589874268, eikonal_loss = 0.1680271178483963, bg_render_loss = 0.0, lop_loss = 0.23345421254634857, lrd_loss = 0.0, semantic_loss = 2.1335763931274414, smooth_loss = 0.0, depth_loss = 0.15482641756534576, normal_l1 = 0.9366717338562012, normal_cos = 0.3322482109069824, psnr = 14.745233535766602
RICO_scannet_1_2024_05_13_17_50_05 [0] (125/465): loss = 0.2314641922712326, rgb_loss = 0.10730314254760742, eikonal_loss = 0.1113850474357605, bg_render_loss = 0.0, lop_loss = 0.07898034900426865, lrd_loss = 0.0, semantic_loss = 1.5100332498550415, smooth_loss = 0.0, depth_loss = 0.19675283133983612, normal_l1 = 0.5104382038116455, normal_cos = 0.10190515220165253, psnr = 17.570865631103516
RICO_scannet_1_2024_05_13_17_50_05 [0] (150/465): loss = 0.3451273441314697, rgb_loss = 0.1835538148880005, eikonal_loss = 0.14887367188930511, bg_render_loss = 0.0, lop_loss = 0.12146244943141937, lrd_loss = 0.0, semantic_loss = 1.6125473976135254, smooth_loss = 0.0, depth_loss = 0.25950920581817627, normal_l1 = 0.802025318145752, normal_cos = 0.2285911589860916, psnr = 12.370896339416504
RICO_scannet_1_2024_05_13_17_50_05 [0] (175/465): loss = 0.3351764976978302, rgb_loss = 0.1563081443309784, eikonal_loss = 0.05132076516747475, bg_render_loss = 0.0, lop_loss = 0.061893969774246216, lrd_loss = 0.0, semantic_loss = 2.131070852279663, smooth_loss = 0.0, depth_loss = 0.26517391204833984, normal_l1 = 0.9160690903663635, normal_cos = 0.2509845495223999, psnr = 14.21097183227539
RICO_scannet_1_2024_05_13_17_50_05 [0] (200/465): loss = 0.24847929179668427, rgb_loss = 0.1240454763174057, eikonal_loss = 0.06325168162584305, bg_render_loss = 0.0, lop_loss = 0.036325085908174515, lrd_loss = 0.0, semantic_loss = 0.9977536201477051, smooth_loss = 0.0, depth_loss = 0.18829357624053955, normal_l1 = 0.8963414430618286, normal_cos = 0.2816430330276489, psnr = 16.257843017578125
RICO_scannet_1_2024_05_13_17_50_05 [0] (225/465): loss = 0.32419532537460327, rgb_loss = 0.14923861622810364, eikonal_loss = 0.12245803326368332, bg_render_loss = 0.0, lop_loss = 0.1727786362171173, lrd_loss = 0.0, semantic_loss = 1.82477867603302, smooth_loss = 0.0, depth_loss = 0.25616592168807983, normal_l1 = 0.8022233843803406, normal_cos = 0.2567409873008728, psnr = 13.886234283447266
slurmstepd: error: *** JOB 38684 ON node003 CANCELLED AT 2024-05-13T17:52:19 ***
